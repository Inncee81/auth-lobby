<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="utf-8">
  <title>Fission Lobby IPFS Worker</title>
</head>
<body>
  <script>
    let channelPort
    const worker = new SharedWorker("worker.min.js")
    window.onmessage = connectPorts

    function connectPorts({ data, ports }) {
      channelPort = ports[0]
      channelPort.onmessage = event => {
        if (data === "DEBUG") console.log("channelMessage", event.data)
        worker.port.postMessage(event.data)
      }

      worker.port.onmessage = event => {
        if (data === "DEBUG") console.log("workerMessage", event.data)
        channelPort.postMessage(event.data)
      }
    }
  </script>
</body>
</html>
